<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Commander Jivesh: Nebula Strike</title>
    <style>
        body {
            margin: 0;
            background: #000;
            overflow: hidden;
            touch-action: none;
            font-family: 'Segoe UI', sans-serif;
            -webkit-user-select: none;
            user-select: none;
        }

        canvas {
            display: block;
            cursor: crosshair;
        }

        #boot-up {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle, #001f3f, #000);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #0ff;
            z-index: 100;
            text-align: center;
            padding: 20px;
        }

        .start-btn {
            background: #0ff;
            color: #000;
            padding: 20px 60px;
            border-radius: 15px;
            font-size: 28px;
            font-weight: 900;
            cursor: pointer;
            border: 4px solid #fff;
            box-shadow: 0 0 50px #0ff;
            transition: 0.3s;
        }

        #hud {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: space-around;
            color: #0ff;
            font-size: 24px;
            font-weight: bold;
            pointer-events: none;
            z-index: 10;
            text-shadow: 0 0 10px #0ff;
        }
    </style>
</head>

<body>

    <div id="hud">
        <div>HERO: JIVESH</div>
        <div>ENERGY: <span id="xp">0</span></div>
    </div>

    <div id="boot-up">
        <h1 style="font-size: 4rem; margin: 0; letter-spacing: 10px;">JIVESH</h1>
        <p style="color: #fff; margin-bottom: 40px; letter-spacing: 5px;">SUPERHERO DATA-QUEST</p>
        <button class="start-btn" onclick="powerOn()">BOOT SYSTEM</button>
    </div>

    <canvas id="game"></canvas>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d', { alpha: false });
        const xpEl = document.getElementById('xp');
        const bootScreen = document.getElementById('boot-up');

        let active = false, score = 0, items = [], particles = [];
        let pX = window.innerWidth / 2, pTargetX = window.innerWidth / 2;
        let audioCtx, masterGain;

        // Music Logic
        function startMusic() {
            const melody = [261.6, 329.6, 392.0, 523.2];
            let i = 0;
            setInterval(() => {
                if (!active) return;
                const osc = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                osc.type = 'triangle';
                osc.frequency.value = melody[i];
                g.gain.setValueAtTime(0.05, audioCtx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5);
                osc.connect(g); g.connect(masterGain);
                osc.start(); osc.stop(audioCtx.currentTime + 0.5);
                i = (i + 1) % melody.length;
            }, 350);
        }

        function playSfx(f, type = 'sine') {
            if (!audioCtx) return;
            const o = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            o.type = type; o.frequency.value = f;
            g.gain.setValueAtTime(0.1, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.3);
            o.connect(g); g.connect(masterGain);
            o.start(); o.stop(audioCtx.currentTime + 0.3);
        }

        function powerOn() {
            // Force browser to allow sound
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            masterGain = audioCtx.createGain();
            masterGain.connect(audioCtx.destination);
            if (audioCtx.state === 'suspended') audioCtx.resume();

            bootScreen.style.display = 'none';
            active = true;
            score = 0;
            items = [];
            startMusic();
            requestAnimationFrame(engine);
        }

        // Mouse & Touch Input
        const updateInput = (e) => {
            pTargetX = e.touches ? e.touches[0].clientX : e.clientX;
        };
        window.addEventListener('mousemove', updateInput);
        window.addEventListener('touchmove', (e) => { e.preventDefault(); updateInput(e); }, { passive: false });

        function drawJivesh(x, y, tilt) {
            ctx.save();
            ctx.translate(x, y + Math.sin(Date.now() / 200) * 10);
            ctx.rotate(tilt);

            // Cape
            ctx.fillStyle = '#d40000';
            ctx.beginPath();
            ctx.moveTo(-15, 0);
            ctx.quadraticCurveTo(-60 - Math.abs(tilt * 40), 30, -5, 65);
            ctx.lineTo(20, 45);
            ctx.fill();

            // Body
            ctx.fillStyle = '#ff6600'; // Orange suit for Jivesh
            ctx.beginPath();
            ctx.roundRect(-25, 0, 50, 60, 15);
            ctx.fill();

            // Name
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('JIVESH', 0, 35);
            ctx.strokeStyle = '#0ff';
            ctx.strokeRect(-20, 22, 40, 18);

            // Helmet
            ctx.fillStyle = '#f0f0f0';
            ctx.beginPath(); ctx.arc(0, -25, 25, 0, 7); ctx.fill();
            ctx.fillStyle = '#ffcc00'; // Visor
            ctx.roundRect(-18, -35, 36, 18, 5); ctx.fill();

            // Jets
            ctx.fillStyle = '#0ff';
            ctx.fillRect(-18, 60, 8, 15 + Math.random() * 10);
            ctx.fillRect(10, 60, 8, 15 + Math.random() * 10);

            ctx.restore();
        }

        function engine() {
            if (!active) return;

            // Clear Background
            ctx.fillStyle = '#000510';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Smooth Movement
            pX += (pTargetX - pX) * 0.15;
            let tilt = (pTargetX - pX) * 0.005;

            drawJivesh(pX, canvas.height - 150, tilt);

            // Objects
            if (Math.random() < 0.04) {
                items.push({ x: Math.random() * canvas.width, y: -50, t: Math.random() > 0.3 ? 'ðŸ•' : 'ðŸ¥¦', s: 5 + (score / 150) });
            }

            for (let i = items.length - 1; i >= 0; i--) {
                let it = items[i];
                it.y += it.s;
                ctx.font = '50px Arial';
                ctx.fillText(it.t, it.x, it.y);

                if (Math.hypot(it.x - pX, it.y - (canvas.height - 150)) < 70) {
                    if (it.t === 'ðŸ•') {
                        score += 10; xpEl.innerText = score;
                        playSfx(880); items.splice(i, 1);
                        for (let j = 0; j < 8; j++) particles.push({ x: it.x, y: it.y, vx: Math.random() * 10 - 5, vy: Math.random() * 10 - 5, l: 1 });
                    } else {
                        active = false; playSfx(150, 'sawtooth');
                        bootScreen.style.display = 'flex';
                        bootScreen.querySelector('h1').innerText = "TRY AGAIN";
                        bootScreen.querySelector('p').innerText = "Jivesh, Broccoli hit the suit! Score: " + score;
                    }
                } else if (it.y > canvas.height + 50) items.splice(i, 1);
            }

            // Particles
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.x += p.vx; p.y += p.vy; p.l -= 0.03;
                ctx.fillStyle = `rgba(0, 255, 255, ${p.l})`;
                ctx.fillRect(p.x, p.y, 4, 4);
                if (p.l <= 0) particles.splice(i, 1);
            }

            requestAnimationFrame(engine);
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();
    </script>
</body>

</html>
